<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<title>í˜„ì¬ ìœ„ì¹˜ì™€ ì§€ë„ ì¶œë ¥</title>
</head>
<body>
  <h3>í˜„ì¬ ìœ„ì¹˜ì™€ ì§€ë„ ì¶œë ¥</h3>
  <hr>

  <!-- ìœ„ì¹˜ ì •ë³´ ì¶œë ¥ -->
  <div id="msg">ì´ê³³ì— ìœ„ì¹˜ ì •ë³´ ì¶œë ¥</div>

  <!-- ì§€ë„ë¥¼ í‘œì‹œí•  iframe -->
  <iframe id="map" width="425" height="350" frameborder="0"
          scrolling="no" marginheight="0" marginwidth="0"></iframe><br>

  <!-- í° ì§€ë„ë¡œ ë³´ê¸° ë§í¬ -->
  <a id="bigmaplink" target="_blank">ìƒˆ ì°½ì— í° ì§€ë„ ë³´ê¸°</a>

  <script>
    if (navigator.geolocation)
      navigator.geolocation.getCurrentPosition(success); // í˜„ì¬ ìœ„ì¹˜ ì •ë³´ ìš”ì²­
    else
      alert("ì´ ë¸Œë¼ìš°ì €ëŠ” ìœ„ì¹˜ ì •ë³´ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");

    // ìœ„ì¹˜ íŒŒì•… ì„±ê³µ ì‹œ ì‹¤í–‰ë˜ëŠ” ì½œë°± í•¨ìˆ˜
    function success(position) {
      let lat = position.coords.latitude;   // ìœ„ë„
      let lon = position.coords.longitude;  // ê²½ë„
      let acc = position.coords.accuracy;   // ì •í™•ë„

      // ë„ˆë¬´ ê¸´ ìˆ«ìëŠ” ë³´ê¸° ì¢‹ê²Œ 6ìë¦¬ê¹Œì§€ë§Œ í‘œì‹œ
      lat = lat.toPrecision(6);
      lon = lon.toPrecision(6);

      // í˜„ì¬ ì‹œê°„
      let now = new Date(position.timestamp);

      // í™”ë©´ì— ì¶œë ¥í•  ì •ë³´ êµ¬ì„±
      let text = "í˜„ì¬ ì‹œê°„: " + now.toUTCString() + "<br>";
      text += "í˜„ì¬ ìœ„ì¹˜ (ìœ„ë„ " + lat + "Â°, ê²½ë„ " + lon + "Â°)<br>";
      text += "ì •í™•ë„: " + acc + "m<br>";
      document.getElementById("msg").innerHTML = text;

      // ğŸ“ OpenStreetMap ì§€ë„ iframeì— í‘œì‹œ
      let map = document.getElementById("map");
      map.src = "https://www.openstreetmap.org/export/embed.html?bbox=" +
                (parseFloat(lon) - 0.01) + "%2C" +
                (parseFloat(lat) - 0.01) + "%2C" +
                (parseFloat(lon) + 0.01) + "%2C" +
                (parseFloat(lat) + 0.01);

      // ğŸ“ â€œìƒˆ ì°½ì—ì„œ ë³´ê¸°â€ ë§í¬ ì„¤ì •
      let maplink = document.getElementById("bigmaplink");
      let zoom = 15; // ìˆ«ìê°€ í´ìˆ˜ë¡ ìì„¸í•œ ì§€ë„
      maplink.href = "https://www.openstreetmap.org/#map=" +
                     zoom + "/" + lat + "/" + lon;
    }
  </script>
</body>
</html> 